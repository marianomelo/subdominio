---
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';

// Obtener todos los posts del blog
const allBlogPosts = await getCollection('blog');

// Ordenar por fecha de publicaci√≥n (m√°s recientes primero)
const sortedPosts = allBlogPosts.sort((a, b) => 
  new Date(b.data.publishedDate).getTime() - new Date(a.data.publishedDate).getTime()
);

const getCategoryColor = (color) => {
  const colors = {
    blue: 'bg-blue-100 text-blue-700',
    orange: 'bg-orange-100 text-orange-700',
    green: 'bg-green-100 text-green-700',
    purple: 'bg-purple-100 text-purple-700',
    red: 'bg-red-100 text-red-700'
  };
  return colors[color] || 'bg-gray-100 text-gray-700';
};

const formatDate = (dateString) => {
  const date = new Date(dateString);
  return date.toLocaleDateString('es-ES', { 
    day: 'numeric', 
    month: 'short', 
    year: 'numeric' 
  });
};
---

<Layout title="Blog" description="Art√≠culos sobre desarrollo web, e-commerce, automatizaci√≥n y tendencias tecnol√≥gicas. Conocimiento compartido por el equipo de Subdominio.">
	<section class="pt-32 pb-16 bg-white">
		<div class="container mx-auto px-6">
			<div class="max-w-4xl mx-auto">
				<div class="mb-8">
					<a href="/" class="inline-flex items-center text-gray-600 hover:text-black transition-colors duration-200 mb-6">
						<svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
						</svg>
						Volver al inicio
					</a>
				</div>
				
				<h1 class="text-5xl md:text-6xl font-medium mb-8 text-black leading-tight">
					Blog
				</h1>
				
				<p class="text-xl text-gray-600 leading-relaxed mb-16 max-w-3xl">
					Art√≠culos sobre desarrollo web, e-commerce, automatizaci√≥n y las √∫ltimas tendencias 
					tecnol√≥gicas. Conocimiento compartido por nuestro equipo.
				</p>
			</div>
		</div>
	</section>

	<!-- Filtros -->
	<section class="py-8 bg-gray-50 border-b border-gray-200">
		<div class="container mx-auto px-6">
			<div class="max-w-6xl mx-auto">
				<div class="flex flex-wrap gap-4 justify-center">
					<button class="px-4 py-2 bg-black text-white font-medium transition-colors duration-200">
						Todos
					</button>
					<button class="px-4 py-2 bg-white text-gray-600 border border-gray-300 hover:text-black hover:border-black transition-colors duration-200">
						Desarrollo Web
					</button>
					<button class="px-4 py-2 bg-white text-gray-600 border border-gray-300 hover:text-black hover:border-black transition-colors duration-200">
						E-commerce
					</button>
					<button class="px-4 py-2 bg-white text-gray-600 border border-gray-300 hover:text-black hover:border-black transition-colors duration-200">
						Automatizaci√≥n
					</button>
					<button class="px-4 py-2 bg-white text-gray-600 border border-gray-300 hover:text-black hover:border-black transition-colors duration-200">
						IA & Tecnolog√≠a
					</button>
					<button class="px-4 py-2 bg-white text-gray-600 border border-gray-300 hover:text-black hover:border-black transition-colors duration-200">
						Casos de Estudio
					</button>
				</div>
			</div>
		</div>
	</section>

	<!-- Art√≠culos destacados -->
	<section class="py-16 bg-white">
		<div class="container mx-auto px-6">
			<div class="max-w-6xl mx-auto">
				<h2 class="text-3xl font-medium mb-12 text-black">
					Art√≠culos Destacados
				</h2>
				
				<!-- Grid de art√≠culos desde archivos Markdown -->
				<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
					{sortedPosts.map((post) => (
						<article class="bg-white border border-gray-200 rounded-lg overflow-hidden hover:shadow-lg transition-shadow duration-200">
							<div class="aspect-video bg-gray-100 flex items-center justify-center">
								<span class="text-gray-400">Imagen del art√≠culo</span>
							</div>
							
							<div class="p-6">
								<div class="flex items-center mb-3">
									<span class={`px-2 py-1 text-xs font-medium rounded ${getCategoryColor(post.data.categoryColor)}`}>
										{post.data.category}
									</span>
									<span class="text-sm text-gray-500 ml-auto">
										{formatDate(post.data.publishedDate)}
									</span>
								</div>
								
								<h3 class="text-xl font-medium text-black mb-3">
									<a 
										href={`/blog/${post.data.slug || post.slug}`} 
										class="hover:text-gray-600 transition-colors duration-200"
									>
										{post.data.title}
									</a>
								</h3>
								
								<p class="text-gray-600 text-sm leading-relaxed mb-4">
									{post.data.excerpt}
								</p>
								
								<div class="flex items-center justify-between">
									<span class="text-xs text-gray-500">
										{post.data.readingTime} min de lectura
									</span>
									<a 
										href={`/blog/${post.data.slug || post.slug}`}
										class="text-sm font-medium text-black hover:text-gray-600 transition-colors duration-200"
									>
										Leer m√°s ‚Üí
									</a>
								</div>
							</div>
						</article>
					))}
				</div>
			</div>
		</div>
	</section>

	<!-- Newsletter/Suscripci√≥n -->
	<section class="py-16 bg-black text-white">
		<div class="container mx-auto px-6 text-center">
			<div class="max-w-2xl mx-auto">
				<h2 class="text-3xl font-medium mb-4">
					¬øTe gust√≥ este contenido?
				</h2>
				<p class="text-gray-300 mb-8">
					Suscr√≠bete para recibir los √∫ltimos art√≠culos sobre desarrollo web, 
					e-commerce y automatizaci√≥n directamente en tu inbox.
				</p>
				
				<form class="flex flex-col sm:flex-row gap-4 max-w-md mx-auto">
					<input
						type="email"
						placeholder="tu@email.com"
						class="flex-1 px-4 py-3 text-black border-0 focus:ring-2 focus:ring-white"
						required
					/>
					<button
						type="submit"
						class="px-6 py-3 bg-white text-black font-medium hover:bg-gray-100 transition-colors duration-200"
					>
						Suscribirse
					</button>
				</form>
				
				<p class="text-xs text-gray-400 mt-4">
					No spam. Solo contenido de calidad. Puedes darte de baja cuando quieras.
				</p>
			</div>
		</div>
	</section>

	<!-- Nota t√©cnica -->
	<section class="py-8 bg-gray-50 border-t border-gray-200">
		<div class="container mx-auto px-6">
			<div class="max-w-4xl mx-auto text-center">
				<p class="text-sm text-gray-500">
					üí° <strong>Nota t√©cnica:</strong> Este blog utiliza archivos Markdown 
					y las <a href="https://docs.astro.build/en/guides/content-collections/" target="_blank" rel="noopener" class="underline hover:text-black">
						Content Collections de Astro
					</a>
					para una gesti√≥n simple y eficiente del contenido.
				</p>
			</div>
		</div>
	</section>
</Layout>